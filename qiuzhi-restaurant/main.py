#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ç§‹èŠåˆ›æ„ç”Ÿæˆå™¨ä¸»å…¥å£
æ ¹æ®ç”¨æˆ·éœ€æ±‚ç”Ÿæˆç¬¦åˆç§‹èŠé¤å…å“ç‰Œè°ƒæ€§çš„åˆ›æ„æ–¹æ¡ˆ
"""

import os
import sys
import argparse
from datetime import datetime

# æ·»åŠ æŠ€èƒ½è·¯å¾„
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '.claude', 'skills', 'qiuzhi-creative', 'scripts'))

def display_brand_info():
    """æ˜¾ç¤ºå“ç‰Œä¿¡æ¯"""
    print("â•”" + "â•" * 60 + "â•—")
    print("â•‘" + " " * 20 + "ç§‹èŠé¤å…åˆ›æ„ç”Ÿæˆå™¨" + " " * 20 + "â•‘")
    print("â•‘" + " " * 15 + "A FRESH, MODERN BITE" + " " * 15 + "â•‘")
    print("â•‘" + " " * 12 + "å¥åº·è½»é£Ÿä¸»ä¹‰ Â· 3DèŒè™¾IP" + " " * 12 + "â•‘")
    print("â•š" + "â•" * 60 + "â•")
    print()

def display_help():
    """æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯"""
    print("ğŸ“– ä½¿ç”¨æ–¹æ³•:")
    print("   python main.py [ç‰©æ–™ç±»å‹]")
    print()
    print("ğŸ¨ æ”¯æŒçš„ç‰©æ–™ç±»å‹:")
    print("   â€¢ æµ·æŠ¥è®¾è®¡ (æµ·æŠ¥, å®£ä¼ æµ·æŠ¥, ä¿ƒé”€æµ·æŠ¥)")
    print("   â€¢ èœå•è®¾è®¡ (èœå•, æ–°å“èœå•, ä»·ç›®è¡¨)")
    print("   â€¢ åŒ…è£…è®¾è®¡ (åŒ…è£…, é¤ç›’, æ‰“åŒ…è¢‹)")
    print("   â€¢ æ¨ªå¹…è®¾è®¡ (æ¨ªå¹…, æ˜“æ‹‰å®, å±•æ¶)")
    print("   â€¢ ç¤¾åª’ç´ æ (å°çº¢ä¹¦å°é¢, å¾®åšé…å›¾, æœ‹å‹åœˆ)")
    print()
    print("ğŸ’¡ ç¤ºä¾‹:")
    print("   python main.py 'æ˜¥å­£æ–°å“æµ·æŠ¥'")
    print("   python main.py 'å¤æ—¥é¥®å“å®£ä¼ å›¾'")
    print("   python main.py 'å‘¨å¹´åº†æ¨ªå¹…'")

def generate_creative_for_material(material_type):
    """
    ä¸ºæ ¸å¿ƒç‰©æ–™ç±»å‹ç”Ÿæˆåˆ›æ„æ–¹æ¡ˆ
    """
    print(f"ğŸ¯ æ­£åœ¨ä¸º '{material_type}' ç”Ÿæˆåˆ›æ„æ–¹æ¡ˆ...")
    print("="*80)
    
    # æ ¹æ®ç‰©æ–™ç±»å‹ç”Ÿæˆç›¸åº”çš„åˆ›æ„å†…å®¹
    # è¿™é‡Œä½¿ç”¨ä¹‹å‰æµ‹è¯•è¿‡çš„é€»è¾‘
    themes = {
        "æµ·æŠ¥": "èŠå‘³ç»½æ”¾ï¼Œè§†è§‰ç››å®´",
        "èœå•": "èŠé¦™æ»¡æº¢ï¼Œå“å‘³ç²¾é€‰",
        "åŒ…è£…": "ä¾¿æºèŠå‘³ï¼Œç¯ä¿åŒè¡Œ",
        "æ¨ªå¹…": "èŠå¿ƒç›¸ä¼´ï¼Œç²¾å½©çº·å‘ˆ",
        "ç¤¾åª’": "èŠè¶£åˆ†äº«ï¼Œæ—¶åˆ»ç²¾å½©"
    }
    
    # ç¡®å®šç‰©æ–™ç±»åˆ«
    category = "æµ·æŠ¥"
    if any(keyword in material_type for keyword in ["èœå•", "ä»·ç›®", "ç‚¹é¤"]):
        category = "èœå•"
    elif any(keyword in material_type for keyword in ["åŒ…è£…", "é¤ç›’", "è¢‹å­", "æ‰“åŒ…"]):
        category = "åŒ…è£…"
    elif any(keyword in material_type for keyword in ["æ¨ªå¹…", "æ˜“æ‹‰å®", "å±•æ¶", " banners"]):
        category = "æ¨ªå¹…"
    elif any(keyword in material_type for keyword in ["ç¤¾åª’", "å°çº¢ä¹¦", "å¾®åš", "æœ‹å‹åœˆ", "social"]):
        category = "ç¤¾åª’"
    
    theme = themes.get(category, themes["æµ·æŠ¥"]) + f" - {material_type}"
    
    # æ ¹æ®å­£èŠ‚å’Œåœºåˆè°ƒæ•´é£æ ¼
    atmospheres = {
        "æµ·æŠ¥": "æ¸…æ–°æ—¶å°šï¼Œè–„è·ç»¿ä¸»è°ƒï¼Œè¥é€ å¹´è½»æ´»åŠ›æ°›å›´",
        "èœå•": "ç²¾è‡´ä¼˜é›…ï¼Œè–„è·ç»¿+å¥¶ç™½è‰²ï¼Œè¥é€ é£Ÿæ¬²æ„Ÿ",
        "åŒ…è£…": "ç®€çº¦å®ç”¨ï¼Œè–„è·ç»¿+åŸæœ¨è‰²ï¼Œè¥é€ ç¯ä¿æ„Ÿ",
        "æ¨ªå¹…": "é†’ç›®å¤§æ°”ï¼Œè–„è·ç»¿+é‡‘è‰²ï¼Œè¥é€ åº†å…¸æ„Ÿ",
        "ç¤¾åª’": "æ—¶å°šå¸ç›ï¼Œè–„è·ç»¿+çŠç‘šæ©™ï¼Œè¥é€ åˆ†äº«æ„Ÿ"
    }
    
    main_elements = {
        "æµ·æŠ¥": "3Dè–„è·ç»¿èŒè™¾IPä½œä¸ºä¸»è§’ï¼Œæ­é…ä¸»é¢˜å…ƒç´ ",
        "èœå•": "3Dè–„è·ç»¿èŒè™¾IPå¼•å¯¼è§†çº¿ï¼Œçªå‡ºèœå“ä¿¡æ¯",
        "åŒ…è£…": "3Dè–„è·ç»¿èŒè™¾IPä½œä¸ºå“ç‰Œæ ‡è¯†ï¼Œç®€æ´å¤§æ–¹",
        "æ¨ªå¹…": "3Dè–„è·ç»¿èŒè™¾IPç½®äºæ˜¾çœ¼ä½ç½®ï¼Œå¸å¼•æ³¨æ„",
        "ç¤¾åª’": "3Dè–„è·ç»¿èŒè™¾IPèå…¥ç¤¾äº¤å…ƒç´ ï¼Œå¢å¼ºäº’åŠ¨"
    }
    
    backgrounds = {
        "æµ·æŠ¥": "æ¸å˜è–„è·ç»¿èƒŒæ™¯ï¼Œæ­é…å‡ ä½•è£…é¥°å…ƒç´ ",
        "èœå•": "ç®€æ´å¥¶ç™½è‰²èƒŒæ™¯ï¼Œçªå‡ºé£Ÿç‰©å›¾ç‰‡å’Œæ–‡å­—",
        "åŒ…è£…": "çº¯è‰²è–„è·ç»¿èƒŒæ™¯ï¼Œç®€æ´ç¯ä¿è´¨æ„Ÿ",
        "æ¨ªå¹…": "æ¸å˜èƒŒæ™¯ï¼ˆè–„è·ç»¿â†’é‡‘è‰²ï¼‰ï¼Œå¢å¼ºè§†è§‰å†²å‡»",
        "ç¤¾åª’": "å¤šå½©èƒŒæ™¯ï¼Œç¬¦åˆç¤¾äº¤åª’ä½“æ´»è·ƒæ°›å›´"
    }
    
    decorative_elements = {
        "æµ·æŠ¥": "å‡ ä½•å›¾å½¢ã€çº¿æ¡è£…é¥°ã€å“ç‰Œå…ƒç´ ç‚¹ç¼€",
        "èœå•": "ç®€çº¦åˆ†å‰²çº¿ã€é£Ÿææ’ç”»ã€è¥å…»æ ‡è¯†",
        "åŒ…è£…": "ç¯ä¿æ ‡è¯†ã€å“ç‰Œlogoã€ç®€æ´è£…é¥°",
        "æ¨ªå¹…": "åº†å…¸å…ƒç´ ã€åŠ¨æ€æ•ˆæœã€å“ç‰Œæ ‡è¯†",
        "ç¤¾åª’": "ç¤¾äº¤å›¾æ ‡ã€åˆ†äº«å…ƒç´ ã€äº’åŠ¨æ ‡è¯†"
    }
    
    detail_themes = {
        "æµ·æŠ¥": [
            "è§†è§‰å±‚æ¬¡æ¸…æ™°ï¼Œé‡ç‚¹çªå‡º",
            "è‰²å½©æ­é…å’Œè°ï¼Œç¬¦åˆå“ç‰Œè°ƒæ€§", 
            "å­—ä½“é€‰æ‹©åˆé€‚ï¼Œæ˜“äºé˜…è¯»",
            "ç•™ç™½é€‚åº¦ï¼Œå‘¼å¸æ„Ÿå¼º",
            "IPå½¢è±¡èå…¥è‡ªç„¶ï¼Œä¸çªå…€",
            "æ•´ä½“é£æ ¼ç»Ÿä¸€ï¼Œä¸“ä¸šæ„Ÿå¼º"
        ],
        "èœå•": [
            "ä¿¡æ¯å±‚çº§åˆ†æ˜ï¼Œæ˜“äºæµè§ˆ",
            "èœå“å±•ç¤ºè¯±äººï¼Œé£Ÿæ¬²æ„Ÿå¼º",
            "ä»·æ ¼æ ‡è¯†æ¸…æ™°ï¼Œæ˜“äºè¯†åˆ«",
            "è¥å…»ä¿¡æ¯æ˜ç¡®ï¼Œå¥åº·å¯¼å‘",
            "IPå½¢è±¡ç‚¹ç¼€ï¼Œå¢åŠ è¶£å‘³",
            "æ•´ä½“ç®€æ´ï¼Œç”¨é¤ä½“éªŒä½³"
        ],
        "åŒ…è£…": [
            "ç¯ä¿æè´¨æ ‡è¯†æ¸…æ™°",
            "å“ç‰Œè¯†åˆ«åº¦é«˜",
            "ç»“æ„å®ç”¨ï¼Œä¾¿äºæºå¸¦",
            "å°ºå¯¸åˆé€‚ï¼Œæˆæœ¬ä¼˜åŒ–",
            "IPå½¢è±¡åº”ç”¨æ°å½“",
            "æ•´ä½“ç¾è§‚ï¼Œæå‡ä½“éªŒ"
        ],
        "æ¨ªå¹…": [
            "æ–‡å­—ä¿¡æ¯é†’ç›®ï¼Œæ˜“äºè¯†åˆ«",
            "IPå½¢è±¡çªå‡ºï¼Œè®°å¿†æ·±åˆ»",
            "è‰²å½©å¯¹æ¯”å¼ºçƒˆï¼Œè§†è§‰å†²å‡»",
            "å°ºå¯¸æ¯”ä¾‹åˆé€‚ï¼Œå±•ç¤ºæ•ˆæœä½³",
            "æè´¨è€ç”¨ï¼Œé€‚åˆæˆ·å¤–",
            "å®‰è£…ä¾¿æ·ï¼Œç»´æŠ¤ç®€å•"
        ],
        "ç¤¾åª’": [
            "é€‚åˆç¼©ç•¥å›¾å±•ç¤º",
            "æ–‡å­—ä¿¡æ¯æ¸…æ™°å¯è¯»",
            "è‰²å½©é²œè‰³ï¼Œå¸å¼•æ³¨æ„",
            "å°ºå¯¸ç¬¦åˆå¹³å°è§„èŒƒ",
            "äº’åŠ¨å…ƒç´ çªå‡º",
            "åˆ†äº«å‹å¥½ï¼Œä¼ æ’­æ€§å¼º"
        ]
    }
    
    brand_messages = {
        "æµ·æŠ¥": "è®¾è®¡æ—¢ç¬¦åˆå®£ä¼ ç›®çš„ï¼Œåˆä¿æŒäº†ç§‹èŠé¤å…å¹´è½»ã€æ¸…æ–°ã€å¥åº·çš„å“ç‰Œè°ƒæ€§",
        "èœå•": "è®¾è®¡æ—¢çªå‡ºäº†èœå“ä¿¡æ¯ï¼Œåˆä½“ç°äº†ç§‹èŠé¤å…ç²¾è‡´ã€å¥åº·ã€æ—¶å°šçš„å“ç‰Œç†å¿µ",
        "åŒ…è£…": "è®¾è®¡æ—¢å®ç”¨ç¯ä¿ï¼Œåˆå¼ºåŒ–äº†ç§‹èŠé¤å…å¥åº·ã€è‡ªç„¶ã€ç°ä»£çš„å“ç‰Œå½¢è±¡",
        "æ¨ªå¹…": "è®¾è®¡æ—¢é†’ç›®å¸å¼•ï¼Œåˆå»¶ç»­äº†ç§‹èŠé¤å…å¹´è½»ã€æ´»åŠ›ã€ä¸“ä¸šçš„å“ç‰Œé£æ ¼",
        "ç¤¾åª’": "è®¾è®¡æ—¢é€‚åˆç¤¾äº¤ä¼ æ’­ï¼Œåˆå½°æ˜¾äº†ç§‹èŠé¤å…æ—¶å°šã€æœ‰è¶£ã€å¥åº·çš„å“ç‰Œä¸ªæ€§"
    }
    
    # ç”Ÿæˆåˆ›æ„è¾“å‡º
    creative_output = {
        "creative_theme": theme,
        "visual_style": {
            "overall_atmosphere": atmospheres[category],
            "color_direction": ["è–„è·ç»¿ #5DDEB5", "å¥¶ç™½è‰²", "åŸæœ¨è‰²", "é‡‘è‰²ç‚¹ç¼€"] if category != "ç¤¾åª’" else ["è–„è·ç»¿ #5DDEB5", "çŠç‘šæ©™", "å¥¶ç™½è‰²", "é‡‘è‰²ç‚¹ç¼€"],
            "texture": "3Då¡é€šé£æ ¼ï¼ŒæŸ”å’Œå…‰å½±ï¼Œè½»å¾®ç£¨ç ‚è´¨æ„Ÿ"
        },
        "composition": {
            "main_elements": main_elements[category],
            "background": backgrounds[category],
            "decorative_elements": decorative_elements[category]
        },
        "detail_suggestions": detail_themes[category],
        "brand_alignment": brand_messages[category],
        "generated_at": datetime.now().isoformat()
    }
    
    # è¾“å‡ºæ ¼å¼åŒ–ç»“æœ
    print(f"### åˆ›æ„ä¸»é¢˜")
    print(f"ï¼ˆ{creative_output['creative_theme']}ï¼‰")
    print()
    
    print(f"### è§†è§‰é£æ ¼")
    print(f"ï¼ˆ{creative_output['visual_style']['overall_atmosphere']}ï¼‰")
    print(f"ï¼ˆé…è‰²æ–¹å‘ï¼š{', '.join(creative_output['visual_style']['color_direction'])}ï¼‰")
    print(f"ï¼ˆè´¨æ„Ÿï¼š{creative_output['visual_style']['texture']}ï¼‰")
    print()
    
    print(f"### ç”»é¢æ„æˆ")
    print(f"ï¼ˆä¸»ä½“å…ƒç´ ï¼š{creative_output['composition']['main_elements']}ï¼‰")
    print(f"ï¼ˆèƒŒæ™¯ï¼š{creative_output['composition']['background']}ï¼‰")
    print(f"ï¼ˆè£…é¥°å…ƒç´ ï¼š{creative_output['composition']['decorative_elements']}ï¼‰")
    print()
    
    print(f"### ç»†èŠ‚å»ºè®®")
    for suggestion in creative_output['detail_suggestions']:
        print(f"ï¼ˆ{suggestion}ï¼‰")
    print()
    
    print(f"### å“ç‰Œå¥‘åˆåº¦")
    print(f"ï¼ˆ{creative_output['brand_alignment']}ï¼‰")
    print()
    
    print(f"â° ç”Ÿæˆæ—¶é—´: {creative_output['generated_at']}")
    print("="*80)
    
    return creative_output

def main():
    parser = argparse.ArgumentParser(description='ç§‹èŠé¤å…åˆ›æ„ç”Ÿæˆå™¨')
    parser.add_argument('material', nargs='?', help='ç‰©æ–™ç±»å‹ï¼ˆå¦‚ï¼šæµ·æŠ¥ã€èœå•ã€åŒ…è£…ç­‰ï¼‰')
    parser.add_argument('--help-more', action='store_true', help='æ˜¾ç¤ºæ›´å¤šå¸®åŠ©ä¿¡æ¯')
    
    args = parser.parse_args()
    
    display_brand_info()
    
    if args.help_more or not args.material:
        if not args.material:
            print("âŒ è¯·è¾“å…¥ç‰©æ–™ç±»å‹")
            print()
        display_help()
        return
    
    # ç”Ÿæˆåˆ›æ„æ–¹æ¡ˆ
    generate_creative_for_material(args.material)

if __name__ == "__main__":
    main()